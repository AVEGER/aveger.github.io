---
title: Linux---任务计划：cron、at
tags: Linux
---

# Linux任务计划

任务计划是Linux系统中非常重要的功能之一，它可以让我们在特定的时间点或者周期性地执行一些特定的任务，这对于自动化系统管理、数据备份、日志清理等任务非常有用。<!--more-->

## 任务计划的基本概念

在Linux系统中，任务计划主要有两种方式：一种是使用`cron`命令，另一种是使用`at`命令。

### `cron`命令

`cron`是Linux系统中用于周期性执行任务的命令。它会在后台运行，每分钟检查一次是否有需要执行的任务。`cron`命令的配置文件为`/etc/crontab`，我们可以通过编辑该文件来设置任务计划。

`/etc/crontab`文件的格式如下：

```
# m h dom mon dow user command
```

其中，各字段的含义如下：

- `m`：表示分钟，取值范围为0-59；
- `h`：表示小时，取值范围为0-23；
- `dom`：表示一个月中的第几天，取值范围为1-31；
- `mon`：表示月份，取值范围为1-12；
- `dow`：表示一周中的第几天，取值范围为0-7，其中0和7都表示星期天；
- `user`：表示执行该任务的用户；
- `command`：表示要执行的命令。

例如，下面是一个每天凌晨3点备份数据库的任务计划：

```
0 3 * * * root /usr/local/bin/backup.sh
```

### `at`命令

`at`命令是Linux系统中用于在指定时间执行任务的命令。与`cron`命令不同，`at`命令只会执行一次，执行完毕后就会自动删除。`at`命令的使用非常简单，只需要指定要执行的时间和要执行的命令即可。

例如，下面是一个在下午2点执行一次备份数据库的任务：

```
$ at 2pm
at> /usr/local/bin/backup.sh
at> <EOT>
```

## 常用的任务计划命令

除了`cron`和`at`命令之外，Linux系统中还有一些其他的任务计划命令，这里向您介绍其中的几个常用命令。

### `crontab`命令

`crontab`命令用于编辑和管理用户的任务计划。它可以让我们在不直接编辑`/etc/crontab`文件的情况下，添加、删除和修改任务计划。

例如，下面是一个添加一个每天凌晨3点备份数据库的任务计划的示例：

```
$ crontab -e
0 3 * * * /usr/local/bin/backup.sh
```

### `atq`命令

`atq`命令用于列出当前用户的所有待执行任务。

例如，下面是一个列出当前用户的所有待执行任务的示例：

```
$ atq
5       Fri May 21 14:00:00 2023 a root
```

### `atrm`命令

`atrm`命令用于删除指定的任务。

例如，下面是一个删除编号为5的任务的示例：

```
$ atrm 5
```

## 总结

任务计划是Linux系统中非常有用的功能，它可以让我们自动化执行一些特定的任务，从而提高系统管理的效率。